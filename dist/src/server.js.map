{"version":3,"sources":["../../src/server.js"],"names":["TelegramBot","require","token","process","env","BOT_TOKEN","bot","polling","userIsAdmin","user","chat","getChatAdministrators","id","then","response","some","el","on","chatId","msg","sticker","text","deleteMessage","message_id","from","name","set_name","author","username","sendMessage"],"mappings":";;AAAA;;AAMA,IAAMA,cAAcC,QAAQ,uBAAR,CAApB;;AAEA,IAAMC,QAAQC,QAAQC,GAAR,CAAYC,SAA1B;;AAEA,IAAMC,MAAM,IAAIN,WAAJ,CAAgBE,KAAhB,EAAuB,EAAEK,SAAS,IAAX,EAAvB,CAAZ;;AAEA;;AAEA,IAAMC,cAAc,SAAdA,WAAc,CAACC,IAAD,EAAOC,IAAP,EAAgB;AAChCJ,QAAIK,qBAAJ,CAA0BD,KAAKE,EAA/B,EAAmCC,IAAnC,CAAwC,oBAAY;AAChD,YAAIC,QAAJ,EAAc,OAAOA,SAASC,IAAT,CAAc;AAAA,mBAAMC,GAAGP,IAAH,CAAQG,EAAR,KAAeH,KAAKG,EAA1B;AAAA,SAAd,CAAP,CAAd,KACK,OAAO,KAAP;AACR,KAHD;AAIH,CALD;;AAOAN,IAAIW,EAAJ,CAAO,SAAP,EAAkB,eAAO;AACrB,QAAMC,SAASC,IAAIT,IAAJ,CAASE,EAAxB;AACA,QAAI,CAACO,IAAIC,OAAL,IAAgB,CAACD,IAAIE,IAAzB,EAA+B;AAC3Bf,YAAIgB,aAAJ,CAAkBH,IAAIT,IAAJ,CAASE,EAA3B,EAA+BO,IAAII,UAAnC;AACH;AACJ,CALD;;AAOAjB,IAAIW,EAAJ,CAAO,MAAP,EAAe,eAAO;AAClB,QAAMC,SAASC,IAAIT,IAAJ,CAASE,EAAxB;AACA,QAAIJ,YAAYW,IAAIK,IAAhB,EAAsBL,IAAIT,IAA1B,CAAJ,EAAqC;AACjCJ,YAAIgB,aAAJ,CAAkBH,IAAIT,IAAJ,CAASE,EAA3B,EAA+BO,IAAII,UAAnC;AACH;AACJ,CALD;;AAOAjB,IAAIW,EAAJ,CAAO,SAAP,EAAkB,eAAO;AACrB,QAAMC,SAASC,IAAIT,IAAJ,CAASE,EAAxB;AACA,QACI,mCAAe;AACXa,cAAMN,IAAIC,OAAJ,CAAYM,QADP;AAEXC,gBAAQR,IAAIK,IAAJ,CAASI;AAFN,KAAf,CADJ,EAMItB,IAAIuB,WAAJ,CAAgBX,MAAhB,EAAwB,SAAxB,EANJ,KAOKZ,IAAIuB,WAAJ,CAAgBX,MAAhB,EAAwB,UAAxB;AACR,CAVD","file":"server.js","sourcesContent":["import {\n    addStickerpack,\n    setupConnection,\n    stickerpackList,\n} from './dataBaseUtils';\n\nconst TelegramBot = require('node-telegram-bot-api');\n\nconst token = process.env.BOT_TOKEN;\n\nconst bot = new TelegramBot(token, { polling: true });\n\nsetupConnection();\n\nconst userIsAdmin = (user, chat) => {\n    bot.getChatAdministrators(chat.id).then(response => {\n        if (response) return response.some(el => el.user.id === user.id);\n        else return false;\n    });\n};\n\nbot.on('message', msg => {\n    const chatId = msg.chat.id;\n    if (!msg.sticker && !msg.text) {\n        bot.deleteMessage(msg.chat.id, msg.message_id);\n    }\n});\n\nbot.on('text', msg => {\n    const chatId = msg.chat.id;\n    if (userIsAdmin(msg.from, msg.chat)) {\n        bot.deleteMessage(msg.chat.id, msg.message_id);\n    }\n});\n\nbot.on('sticker', msg => {\n    const chatId = msg.chat.id;\n    if (\n        addStickerpack({\n            name: msg.sticker.set_name,\n            author: msg.from.username,\n        })\n    )\n        bot.sendMessage(chatId, 'принято');\n    else bot.sendMessage(chatId, 'уже было');\n});\n"]}